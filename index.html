<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Page Title</title>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
</head>

<body>

    <h1>Naturviternes lønnsstatistikk</h1>

    <button id="getData">Hent data</button>
    <div id="output"></div>
    <div id="container" style="width:100%; height:400px;"></div>



    <script type="module">

        document.getElementById('getData').addEventListener
            ('click', getData);

        function getData() {
            // fetch('/einar/data')
            //     .then(function (res) {
            //         return (res.json());
            //     })
            //     .then(function (data) {
            //         console.log(data)
            //     })

            fetch('/einar/data')
                .then((res) => res.json())
                .then((data) => {

                    let output = '<h2>Lønn</h2>'
                    
                    const privat = data.find(element => element["Sektor"] === 'Privat');
                    const stat = data.find(element => element["Sektor"] === 'Stat');
                    const kommune = data.find(element => element["Sektor"] === 'Kommune');

                    data.forEach(data => {
                        console.log("Sektor: ", data["Sektor"]);
                        console.log("Gjennomsnittslønn: ", data["Gjennomsnittslønn"]);

                        output += `Sektor: ${data["Sektor"]} OG gjennomsnittslønn: ${data["Gjennomsnittslønn"]}`;
                        
                        output+= "</br></br>"

                     });
                    document.getElementById('output').innerHTML = output;

                    let options = {
                        chart: {
                            renderTo: 'container',
                        },
                        title: {
                        text: 'Historisk lønnsutvikling etter sektor'
                        },
                        xAxis: {
                            categories: [2012, 2013, 2014, 2015, 2016, 2017, 2018]
                        },
                        yAxis: {
                            title: {
                                text: 'Lønn'
                            }
                        },
                        series: []
                    };

                    options.series.push({
                        name: 'Kommune',
                        data: [500, 520, 540, 520, 560],
                        color: 'blue',
                    })

                     options.series.push({
                        name: 'Stat',
                        data: [600, 610, 640, 650, 660],
                        color: 'red',
                    })

                     options.series.push({
                        name: 'Privat',
                        data: [450, 500, 520, 540, 600, 620],
                        color: 'green',
                    })

                let chart = new Highcharts.Chart(options);
                     

                });
        }
        //         .then((data) => console.log(data.recordsets[0][0]["Sektor"]))
        // }

            // {
            //     chart.series[0].addPoint({ x: data.timestamp * 1000, y: Number(data.ticker.price) })

              

    </script>

    <p><a href="/Lonn">Link til lønn</a></p>
</body>

</html>